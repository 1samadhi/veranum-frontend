<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Habitaciones – Veranum</title>
  <link href="/app/assets/css/tailwind.css" rel="stylesheet">
  <script>
    // Protección de roles
    const allow = ['admin','recepcion'];
    const role  = (sessionStorage.getItem('role')||'').toLowerCase();
    if (!allow.includes(role)) {
      alert('Sin permiso: role="'+role+'"');
      window.location='login.html';
    }
  </script>
</head>
<body class="min-h-screen bg-gray-100 flex flex-col">

  <!-- NAVBAR -->
  <div id="navbar"></div>

  <main class="flex-grow container mx-auto p-6">

    <!-- Header y botón Nuevo -->
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-semibold">Gestión de Habitaciones</h1>
      <button id="btn-new"
              class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">
        + Nueva Habitación
      </button>
    </div>

    <!-- FORMULARIO OCULTO, se mostrará al hacer click en "+ Nueva Habitación" -->
    <div id="form-container" class="hidden bg-white shadow rounded-md p-6 mb-6">
      <h2 id="form-title" class="text-lg font-medium mb-4">Nueva Habitación</h2>
      <form id="habitacion-form" class="space-y-4">
        <div>
          <label for="form-hotel" class="block text-sm font-medium text-gray-700">Hotel</label>
          <select id="form-hotel" name="hotel_id"
                  class="mt-1 block w-full border-gray-300 rounded-md" required>
            <option value="">Cargando hoteles…</option>
          </select>
        </div>
        <div>
          <label for="form-nombre" class="block text-sm font-medium text-gray-700">Nombre</label>
          <input id="form-nombre" name="nombre" type="text" required
                 class="mt-1 block w-full border-gray-300 rounded-md">
        </div>
        <div>
          <label for="form-precio" class="block text-sm font-medium text-gray-700">Precio diario</label>
          <input id="form-precio" name="precio" type="number" step="0.01" required
                 class="mt-1 block w-full border-gray-300 rounded-md">
        </div>
        <div class="flex justify-end space-x-2">
          <button type="button" id="form-cancel"
                  class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">
            Cancelar
          </button>
          <button type="submit"
                  class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">
            Guardar
          </button>
        </div>
      </form>
    </div>

    <!-- TABLA DE HABITACIONES -->
    <div class="bg-white shadow rounded overflow-auto">
      <table class="min-w-full">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left">ID</th>
            <th class="px-6 py-3 text-left">Hotel</th>
            <th class="px-6 py-3 text-left">Nombre</th>
            <th class="px-6 py-3 text-left">Precio</th>
            <th class="px-6 py-3 text-center">Acciones</th>
          </tr>
        </thead>
        <tbody id="habitacion-tbody" class="divide-y divide-gray-200"></tbody>
      </table>
    </div>

  </main>

  <!-- SCRIPTS -->
  <script src="/app/js/api.js"></script>
  <script src="/app/js/navbar.js"></script>
  <script src="/app/js/habitaciones.js"></script>
</body>
</html>
